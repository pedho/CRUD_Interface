<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Instrument+Sans:ital,wght@0,400..700;1,400..700&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <title>Projeto de Restaurante</title>
</head>
<body>
    
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand m-3" href="#">MeuRestauranteDigital</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Alterna navegação">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
            <li class="nav-item m-4">
                <button type="button" class="btn btn-primary" onclick="itemlist()" data-bs-toggle="modal" data-bs-target="#listItemModal">Listar pratos</button>
            </li>
            <li class="nav-item m-4">
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addItemModal" data-whatever="@mdo">Adicionar prato</button>
            </li>
            <li class="nav-item m-4">
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#deleteItemModal" data-whatever="@mdo">Remover prato</button>
            </li>
            <li class="nav-item m-4">
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editItemModal" data-whatever="@mdo">Atualizar prato</button>
            </li>
            
            <li class="nav-item m-4">
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#searchItemModal" data-whatever="@mdo">Buscar prato</button>
            </li>
            </ul>
        </div>
    </nav>
    
    

    <div class="modal fade" id="addItemModal" tabindex="-1" role="dialog" aria-labelledby="addItemModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Novo Prato</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body">
            <form>
            <div class="form-group">
                <label for="nomePrato" class="col-form-label">Nome do Prato:</label>
                <input type="text" class="form-control" id="nomePrato">
            </div>
            <div class="form-group">
                <label for="valorPrato" class="col-form-label">Valor do Prato:</label>
                <input type="text" class="form-control" id="valorPrato">
            </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
            <button type="button" class="btn btn-primary" onclick="additem()" data-bs-dismiss="modal">Enviar</button>
        </div>
        </div>
    </div>
    </div>

    <div class="modal fade" id="editItemModal" tabindex="-1" role="dialog" aria-labelledby="editItemModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Editar Prato</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body">
            <form>
            <div class="form-group">
                <label for="nomePratoEdit" class="col-form-label">Nome antigo do Prato:</label>
                <input type="text" class="form-control" id="nomePratoEdit">
            </div>
            <div class="form-group">
                <label for="novoNomePrato" class="col-form-label">Novo nome do Prato:</label>
                <input type="text" class="form-control" id="novoNomePrato">
            </div>
            <div class="form-group">
                <label for="novoValorPrato" class="col-form-label">Novo valor do Prato:</label>
                <input type="text" class="form-control" id="novoValorPrato">
            </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
            <button type="button" class="btn btn-primary" onclick="edititem()" data-bs-dismiss="modal">Enviar</button>
        </div>
        </div>
    </div>
    </div>


    <div class="modal fade" id="deleteItemModal" tabindex="-1" role="dialog" aria-labelledby="deleteItemModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Remover Prato</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>

        </div>
        <div class="modal-body">
            <form>
            <div class="form-group">
                <label for="nomePratoDelete" class="col-form-label">Nome do Prato:</label>
                <input type="text" class="form-control" id="nomePratoDelete">
            </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
            <button type="button" class="btn btn-primary" onclick="removeitem()" data-bs-dismiss="modal">Remover</button>
        </div>
        </div>
    </div>
    </div>


    <div class="modal fade" id="searchItemModal" tabindex="-1" role="dialog" aria-labelledby="searchItemModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Buscar Prato</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>

        </div>
        <div class="modal-body">
            <form>
            <div class="form-group">
                <label for="nomePratoSearch" class="col-form-label">Nome do Prato:</label>
                <input type="text" class="form-control" id="nomePratoSearch">
            </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
            <button type="button" class="btn btn-primary" onclick="searchitem()" data-bs-dismiss="modal">Buscar</button>
        </div>
        </div>
    </div>
    </div>

    
    <div class="modal fade" id="feedbackModal" tabindex="-1" aria-labelledby="feedbackModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="feedbackModalLabel">Resultado de busca:</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body" id="feedbackModalBody">
            <h4>Nome do prato: </h4>
            <h5 id="resultNomePrato"></h5>
            <h4>Valor do prato: </h4>
            <h5 id="resultValorPrato"></h5>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="resultreset()">OK</button>
        </div>
        </div>
    </div>
    </div>

    <div class="modal fade" id="listItemModal" tabindex="-1" aria-labelledby="listItemModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="listItemModalLabel">Lista de Pratos</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body">
            <ul class="list-group" id="listContainer"></ul>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
        </div>
        </div>
    </div>
    </div>


    <script>
        const url = "https://688cc002cd9d22dda5ce5a4b.mockapi.io/api/v1/pratos"
        

        class Item{
            constructor(nome, valor){
                this.nome = nome
                this.valor = valor
            }
        } 

        function additem(){
            item_nome = document.getElementById("nomePrato").value;
            item_valor = document.getElementById("valorPrato").value;

            fetch(url, {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({
                    nome: item_nome,
                    valor: item_valor
                })
            }).then(res => res.json())
            .then(() =>itemlist())

            document.getElementById("nomePrato").value = ""
            document.getElementById("valorPrato").value = ""
        }

        function edititem(){
            item_nome_busca = document.getElementById("nomePratoEdit").value;
            item_nome = document.getElementById("novoNomePrato").value;
            item_valor = document.getElementById("novoValorPrato").value;

            fetch(url)
                .then(res => res.json())
                .then(data => {
                    var item_busca = data.find(function(object){ return object.nome === item_nome_busca})

                    if(!item_busca){
                        alert("Prato não encontrado")
                        return;
                    }

                    fetch(`${url}/${item_busca.id}`, {
                        method: "PUT",
                        headers: {"Content-Type": "application/json"},
                        body: JSON.stringify({
                            nome: item_nome,
                            valor: item_valor
                        })
                    }).then(() => itemlist())
                })

            document.getElementById("nomePratoEdit").value = "";
            document.getElementById("novoNomePrato").value = "";
            document.getElementById("novoValorPrato").value = "";

        }

        function removeitem(){
            item_nome_busca = document.getElementById("nomePratoDelete").value;

            fetch(url)
                .then(res => res.json())
                .then(data => {
                    var item_busca = data.find(function(object){return object.nome === item_nome_busca})

                    if(!item_busca){
                        alert("Prato não encontrado")
                        return;
                    }

                    fetch(`${url}/${item_busca.id}`, {
                        method: "DELETE"
                    })
                    .then(() => itemlist())
                })

            document.getElementById("nomePratoDelete").value = "";
        }

        function searchitem(){
            item_nome = document.getElementById("nomePratoSearch").value
            fetch(url)
                .then(res => res.json())
                .then(data => {
                    var item_busca = data.find(function(object){ return object.nome === item_nome})

                    if(!item_busca){
                        alert("Prato não encontrado")
                        document.getElementById("resultNomePrato").innerText = "Não encontrado"
                        document.getElementById("resultValorPrato").innerText = "N/A"
                        return;
                    } else {
                        document.getElementById("resultNomePrato").innerText = item_busca.nome
                        document.getElementById("resultValorPrato").innerText = "R$ " + item_busca.valor
                    }

                })
            
            const feedbackModal = new bootstrap.Modal(document.getElementById('feedbackModal'));
            feedbackModal.show();

            document.getElementById("nomePratoSearch").value = "";

        }

        function resultreset(){
            document.getElementById("resultNomePrato").value = "";
            document.getElementById("resultValorPrato").value = "";
        }


        function itemlist() {
            const listContainer = document.getElementById("listContainer");
            listContainer.innerHTML = ""; 

            fetch(url)
                .then(res => res.json())
                .then(data => {
                    if (data.length === 0) {
                        const emptyItem = document.createElement("li");
                        emptyItem.className = "list-group-item text-center text-muted";
                        emptyItem.innerText = "Nenhum prato cadastrado.";
                        listContainer.appendChild(emptyItem);
                        return;
                    }

                    data.forEach(item => {
                        const listItem = document.createElement("li");
                        listItem.className = "list-group-item";
                        listItem.innerText = `${item.nome} - R$ ${item.valor}`;
                        listContainer.appendChild(listItem);
                    });
                })
        }


    </script>



</body>
</html>